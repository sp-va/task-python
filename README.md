# API для отслеживания состояния доступности сторонних сервисов

## Установка
Клонируем репозиторий, активируем виртуальное окружение, устанавливаем зависимости из requirements.txt
``` bash
git clone https://github.com/sp-va/task-python.git

python3 -m venv venv

..venv\Scripts\activate

pip install -r requirements.txt
```

## Запуск
Либо напрямую через uvicorn
``` bash
uvicorn src.main:app --reload
```

Либо собираем docker-compose и поднимаем его (предварительно запустив движок docker на локальной машине)

```bash
docker-compose build
docker-compose up
```

## Эндпоинты
Все эндпоинты доступны через роутер '/services_statuses'. Все их можно протестировать по /docs и /redoc.

### POST /add/
Принимает параметры:
- name - название сервиса;
- service_status - состояние сервиса (принимает только значения online, offline, unstable);
- description - описание сервиса.

Используется для добавления новой записи о состоянии сервиса. Возвращает помимо введенных параметров значения id и created_at.

### GET /list/
Не принимает никаких параметров. Выдает список актуальных состояний для каждого из существующих в базе данных сервисов.

### GET /retrieve/
Принимает параметр name. Возвращает список всех состояний для указанного сервиса с сортировкой от новых к старым записям.

### GET /sla_info/
Принимает параметры:
- name;
- start_name, end_name - начало и конец желаемого временного интервала для отображения статистики. По умолчанию принимает интервал за последние 24 часа.

Возвращает:
- суммарную продолжительность времени, когда сервис был в состоянии offline, либо unstable;
- SLA в процентах до 3-й запятой.
